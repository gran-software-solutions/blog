"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[4931],{1589:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/image6-978cc28f597bc7006d34ccee14bc6411.png"},1880:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/cover-image-94008e26c0d49356319938dd76cf19ad.png"},2807:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/image4-df4626d03b23101b15f96cbc18bfd921.png"},5680:(e,t,n)=>{n.d(t,{xA:()=>m,yg:()=>d});var a=n(6540);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function i(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},m=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},g=a.forwardRef(function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,m=i(e,["components","mdxType","originalType","parentName"]),p=c(n),g=o,d=p["".concat(l,".").concat(g)]||p[g]||u[g]||r;return n?a.createElement(d,s(s({ref:t},m),{},{components:n})):a.createElement(d,s({ref:t},m))});function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,s=new Array(r);s[0]=g;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[p]="string"==typeof e?e:o,s[1]=i;for(var c=2;c<r;c++)s[c]=n[c];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}g.displayName="MDXCreateElement"},5905:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/image2-54fa29c2ea205ce8cf0719b57d66712f.png"},6922:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/image1-d7b803eb7bc253797b3c6c509c69fd5d.png"},7640:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/image3-10f1c00f4ceab35e82a8571cc252d6f0.png"},9041:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(6540);const o=function(e){const t=e.width?{width:`${e.width}px`}:{};return void 0!==e.title?a.createElement("center",null,a.createElement("figure",null,a.createElement("img",{src:e.src,alt:e.alt,style:t}),a.createElement("figcaption",{style:{textAlign:"center"}},e.title))):a.createElement("img",{src:e.src,alt:e.alt,style:t})}},9437:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>g,frontMatter:()=>s,metadata:()=>l,toc:()=>m});var a=n(8168),o=(n(6540),n(5680)),r=n(9041);const s={title:"Weekly Sheetty Scoop\ud83c\udf66 #2",authors:"gglazewskigran",tags:["sheetty","weekly"],enableComments:!0},i=void 0,l={permalink:"/2024/03/29/weekly-sheetty-scoop-2",source:"@site/blog/2024-03-29-weekly-sheetty-scoop-2/index.mdx",title:"Weekly Sheetty Scoop\ud83c\udf66 #2",description:"This week started off with permission management. Many tricky questions arose during the implementation and we tried to answer them as simply as possible. Besides this, a row of QoL improvements, like fuzzy search or smoother quick actions navigation, were implemented. All right, let\u2019s crack this ice cream box open.",date:"2024-03-29T00:00:00.000Z",formattedDate:"March 29, 2024",tags:[{label:"sheetty",permalink:"/tags/sheetty"},{label:"weekly",permalink:"/tags/weekly"}],readingTime:3.85,hasTruncateMarker:!0,authors:[{name:"Greg Glazewski",title:"Software Engineer @ GRAN Software Solutions GmbH",url:"https://www.linkedin.com/in/greg-glazewski-88390827",imageURL:"https://github.com/gglazewskigran.png",key:"gglazewskigran"}],frontMatter:{title:"Weekly Sheetty Scoop\ud83c\udf66 #2",authors:"gglazewskigran",tags:["sheetty","weekly"],enableComments:!0},prevItem:{title:"Weekly Sheetty Scoop\ud83c\udf66 #3",permalink:"/2024/04/12/weekly-sheetty-scoop-3"},nextItem:{title:"Weekly Sheetty Scoop\ud83c\udf66 #1",permalink:"/2024/03/22/weekly-sheetty-scoop-1"}},c={authorsImageUrls:[void 0]},m=[{value:"Teams",id:"teams",level:2},{value:"How to do it?",id:"how-to-do-it",level:2},{value:"QoL",id:"qol",level:2},{value:"What\u2019s Next?",id:"whats-next",level:2}],p={toc:m},u="wrapper";function g({components:e,...t}){return(0,o.yg)(u,(0,a.A)({},p,t,{components:e,mdxType:"MDXLayout"}),(0,o.yg)("p",null,"This week started off with permission management. Many tricky questions arose during the implementation and we tried to answer them as simply as possible. Besides this, a row of QoL improvements, like fuzzy search or smoother quick actions navigation, were implemented. All right, let\u2019s crack this ice cream box open."),(0,o.yg)("p",null,(0,o.yg)("img",{alt:"Weekly Sheetty Scoop #2",src:n(1880).A,title:"Weekly Sheetty Scoop #2",width:"960",height:"540"})),(0,o.yg)("h2",{id:"teams"},"Teams"),(0,o.yg)("p",null,"John has been working on the \u201cImportante\u201d project for decades. But now it\u2019s finished and Tim, the manager, doesn\u2019t want John to log time for \u201cImportante\u201d anymore."),(0,o.yg)("p",null,"What happens now?"),(0,o.yg)(r.A,{src:n(2807).A,alt:"Three time entries visible",title:"John can see entries from Importante project.",mdxType:"MyImg"}),(0,o.yg)("p",null,"Tim, most likely, will remove the access to the \u201cImportante\u201d project from John\u2019s team."),(0,o.yg)(r.A,{src:n(9790).A,alt:"Permissions management for a team",title:"Tim can control what projects and clients are visible for each team.",mdxType:"MyImg"}),(0,o.yg)("p",null,"Logically, no member of this team, including John, should see the \u201cImportante\u201d project, nor time entries logged for it."),(0,o.yg)(r.A,{src:n(7640).A,alt:"Only two time entries visible",title:"John now cannot see time entries for Importante project.",mdxType:"MyImg"}),"Is this correct? From John\u2019s perspective, all of his work is gone. Logged time won\u2019t appear in his time tracking reports.",(0,o.yg)("p",null,"Tim, his manager, will see it, sure. But John loses this data and the information gap between John and Tim grows and John cannot really reason about what he worked on."),(0,o.yg)("p",null,"Things get hairy if John is a freelancer and needs to export timesheets or simply wants to monitor his work."),(0,o.yg)("p",null,"As we see, it\u2019s not the greatest solution but a great first step, nevertheless. We\u2019re going to implement it like this, because it\u2019s good enough. And it allows us to build on it and expand the permission system to become more sophisticated in the future."),(0,o.yg)("h2",{id:"how-to-do-it"},"How to do it?"),(0,o.yg)("p",null,"Our current data model doesn\u2019t necessarily make the task easy, though."),(0,o.yg)("p",null,"We want to do the following:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"check if any of the teams"),(0,o.yg)("li",{parentName:"ul"},"to which the user belongs"),(0,o.yg)("li",{parentName:"ul"},"has access to the project"),(0,o.yg)("li",{parentName:"ul"},"or client")),(0,o.yg)("p",null,"And our database schema looks like this:"),(0,o.yg)(r.A,{src:n(6922).A,alt:"A visual representation of our database schema",title:"",mdxType:"MyImg"}),(0,o.yg)("p",null,"The graph below shows where data we\u2019re interested in (projects) resides:"),(0,o.yg)(r.A,{src:n(1589).A,alt:"Nested circles showing how the data is nested",title:"",mdxType:"MyImg"}),(0,o.yg)("p",null,"And it\u2019s fairly easy to do with SQL. First, define which teams we are looking for (which client and which member). Then collect projects from those teams and clients."),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-sql"},"with teams as (select id, name, clients from team where 'dd08d05c-fd2a-4f32-92f7-b3df994b286f' = ANY (team.members)),\n    clients as (select client.id, client.name\n                from client\n                         join teams on client.id = any (teams.clients)),\n    clients_projects as (select array_agg(project.id) as list from clients join project ON project.client_id = clients.id),\n    projects as (select array_agg(project.id) as list from project join teams on project.id = any (teams.clients))\n")),(0,o.yg)("p",null,"A little inconvenience we are facing here is the fact that the teams.clients column contains UUID of both projects and clients. It\u2019s most certainly not the best approach, but it works for now and that\u2019s all right."),(0,o.yg)("p",null,"Later you can filter your results:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-sql"},"AND (te.project_id = any(select unnest(list) from clients_projects)\n   OR\n   te.project_id = any(select unnest(list) from projects)\n   OR\n    te.project_id is null\n)\n")),(0,o.yg)("h2",{id:"qol"},"QoL"),(0,o.yg)("p",null,"Fuzzy search in task descriptions! The autocomplete logic was very simple:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-javascript"},"const options = computed(() => autocomplete.value.map(ac => {\n    if (!description.value) return false\n    if (!ac.toLowerCase().startsWith(description.value.toLowerCase())) return false;\n    return {\n        label: ac,\n        value: ac,\n    }\n}).filter(i => i));\n")),(0,o.yg)("p",null,"Very sophisticated \ud83d\ude0a"),(0,o.yg)("p",null,"But we switched over to ",(0,o.yg)("a",{parentName:"p",href:"https://fuse.js"},"fuse.js")," and now it\u2019s much more interesting."),(0,o.yg)(r.A,{src:n(5905).A,alt:"Autocomplete uses fuzzy search to match query",title:"Fuzzy search allows for more creative queries",mdxType:"MyImg"}),"Here's how we implemented autocomplete using fuse.js:",(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-javascript"},"const options = computed(() => {\n    if (!desc.value) return [];\n    const fuse = new Fuse(autocomplete.value, {\n        includeScore: true,\n        minMatchCharLength: 3,\n        useExtendedSearch: true,\n    });\n\n    return fuse.search(desc.value).map(f => {\n        return {\n            label: f.item,\n            value: f.item,\n        }\n    });\n})\n")),(0,o.yg)("p",null,"Besides, we increased contrast in all of the select inputs to improve readability and improved flow while using quick actions. Previously it would require us to tap ESC to close it, now it\u2019ll close automatically after an action is executed"),(0,o.yg)("h2",{id:"whats-next"},"What\u2019s Next?"),(0,o.yg)("p",null,"You can expect some more QoL improvements. We actively use the tool and plan some smaller tasks each week. Teams are our main focus now, but it\u2019s a really big feature so we want to roll out some smaller updates too."),(0,o.yg)("p",null,"Some new screens of Teams and more details about implementation coming up, too."),(0,o.yg)("p",null,"Thank you for reading!"),(0,o.yg)("p",null,"But don\u2019t just read. Try it out now. It only takes 1 minute: ",(0,o.yg)("a",{parentName:"p",href:"https://consultingcockpit.com"},"consultingcockpit.com"),"\nAnd with a 90 day trial, you can\u2019t go wrong."))}g.isMDXComponent=!0},9790:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/image5-780493278ed5517c195e4bf8f53af2d6.png"}}]);